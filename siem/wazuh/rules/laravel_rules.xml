<group name="laravel_soc">

  <rule id="100100" level="3">
    <decoded_as>json</decoded_as>
    <description>Laravel application log detected</description>
  </rule>

  <rule id="100101" level="10" frequency="5" timeframe="60">
    <if_matched_sid>100100</if_matched_sid>
    <match>auth.failed</match>
    <description>SOC-LARAVEL-001: Brute Force Attempt Detected</description>
    <group>laravel_socattack,authentication_failed</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>

  <rule id="100102" level="7">
    <if_sid>100100</if_sid>
    <match>admin|dashboard|manage</match>
    <description>SOC-LARAVEL-003: Access attempt to restricted endpoint</description>
    <group>laravel_socattack,web,access_control</group>
    <mitre>
      <id>T1087</id>
    </mitre>
  </rule>

  <rule id="100103" level="12">
    <if_sid>100100</if_sid>
    <match>SQLSTATE|syntax error|QueryException|UNION SELECT</match>
    <description>SOC-LARAVEL-002: SQL Injection pattern detected</description>
    <group>laravel_socattack,sql_injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>

</group>